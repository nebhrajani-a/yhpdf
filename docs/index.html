<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-21 Thu 15:57 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Yash Honda PDF (=yhpdf=) Manual</title>
<meta name="author" content="Nebhrajani A.V." />
<meta name="generator" content="Org Mode" />
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/htmlize.css"/>
<link rel="stylesheet" type="text/css" href="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/css/readtheorg.css"/>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/lib/js/jquery.stickytableheaders.min.js"></script>
<script type="text/javascript" src="https://fniessen.github.io/org-html-themes/src/readtheorg_theme/js/readtheorg.js"></script>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "center",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "TeX"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "TeX"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "right",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<h1 class="title">Yash Honda PDF (<code>yhpdf</code>) Manual</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgf6f81df">1. Installation</a>
<ul>
<li><a href="#orgc3c0332">1.1. Basic</a></li>
<li><a href="#orgc4c1d86">1.2. Advanced</a></li>
</ul>
</li>
<li><a href="#orgb9c8997">2. Usage</a></li>
<li><a href="#org8f767ba">3. Technical Description</a>
<ul>
<li><a href="#org3cab299">3.1. What?</a></li>
<li><a href="#org597ef8a">3.2. How?</a></li>
<li><a href="#org38cea13">3.3. Known Issues</a></li>
</ul>
</li>
<li><a href="#org4b74d66">4. <code>yhpdf.py</code> Source</a></li>
</ul>
</div>
</div>

<div id="outline-container-orgf6f81df" class="outline-2">
<h2 id="orgf6f81df"><span class="section-number-2">1.</span> Installation</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-orgc3c0332" class="outline-3">
<h3 id="orgc3c0332"><span class="section-number-3">1.1.</span> Basic</h3>
<div class="outline-text-3" id="text-1-1">
<p>
Use MS Windows 10.
</p>

<ol class="org-ol">
<li>Install <b>Ghostscript (64-bit)</b>:
<ol class="org-ol">
<li>Go to <span class="underline"><a href="https://ghostscript.com/releases/gsdnld.html">https://ghostscript.com/releases/gsdnld.html</a></span>.</li>
<li>Download the file <b>Ghostscript for Windows (64 bit)</b> with
the AGPL license. <span class="underline">Do not use the 32 bit
version, it is incompatible with <code>yhpdf</code>.</span></li>
<li>Run the installer with the standard steps, and click <code>Finish</code>
once done. It should launch a website, telling you Ghostscript
is installed.</li>
</ol></li>
<li>Get <b>yhpdf</b>:
<ol class="org-ol">
<li>Download <code>yhpdf.exe</code> from
<span class="underline"><a href="https://nebhrajani-a.github.io/yhpdf/yhpdf.exe">https://nebhrajani-a.github.io/yhpdf/yhpdf.exe</a></span>. Your
browser may call it &ldquo;Dangerous&rdquo; since it&rsquo;s not a
Microsoft-verified program. Click the arrow for options and
select &ldquo;Keep&rdquo;.</li>
<li>Copy <code>yhpdf</code> from your <code>Downloads</code> folder and paste it in
<code>C:\Program Files</code> (This PC \(\rightarrow\) Local Disk
\(\rightarrow\) Program Files).</li>
<li>Double click on <code>yhpdf</code>.
<ol class="org-ol">
<li>If &ldquo;Windows protected your PC&rdquo; launches, click &ldquo;More
info&rdquo;, then select &ldquo;Run anyway&rdquo; on the bottom right.
Windows will remember your preference.</li>
<li><span class="underline">Wait for 20 seconds</span>. If it doesn&rsquo;t
launch, double click again, and wait for 10 more seconds. On
old machines, <code>yhpdf</code> takes time to start up. Be patient, it
runs much faster than it starts.</li>
</ol></li>
<li>Once it starts, you should see a window with four buttons and
some text. Go down to the taskbar, right click on <code>yhpdf</code>&rsquo;s
feather icon, and select &ldquo;Pin to taskbar&rdquo;.</li>
<li><code>yhpdf</code> is now ready for use.</li>
<li>If <code>yhpdf</code> doesn&rsquo;t start and reports an error, make sure
Ghostscript is installed. If there&rsquo;s some other error you
can&rsquo;t resolve, report it to the package maintainer.</li>
</ol></li>
</ol>
</div>
</div>

<div id="outline-container-orgc4c1d86" class="outline-3">
<h3 id="orgc4c1d86"><span class="section-number-3">1.2.</span> Advanced</h3>
<div class="outline-text-3" id="text-1-2">
<p>
On any platform, install Python 3 and Ghostscript 64-bit. Then,
<code>pip3 install pypdf2 ghostscript</code>. Run with <code>python3 yhpdf.py</code>.
</p>
</div>
</div>
</div>

<div id="outline-container-orgb9c8997" class="outline-2">
<h2 id="orgb9c8997"><span class="section-number-2">2.</span> Usage</h2>
<div class="outline-text-2" id="text-2">
<p>
Usage is intuitive:
</p>

<ol class="org-ol">
<li>Click &ldquo;Select a file&rdquo; to upload the PDF you want to split and
compress.
<ol class="org-ol">
<li>A popup will tell you which file has been selected.
Click &ldquo;OK&rdquo;.</li>
</ol></li>
<li>Click &ldquo;Select output folder&rdquo; to select the folder into which the
new PDFs will be put.
<ol class="org-ol">
<li>A popup will tell you which folder has been selected. Click
&ldquo;OK&rdquo;.</li>
</ol></li>
<li>Click &ldquo;Process PDF&rdquo; to process the PDF. This can take up to 60
seconds, depending on the speed of your machine and the size of
the input PDF.
<ol class="org-ol">
<li><span class="underline">Do not close <code>yhpdf</code> even if Windows says &ldquo;Not Responding&rdquo;</span>.
Killing <code>yhpdf</code> may damage the output. Wait for it to
complete.</li>
<li>Once the PDF process is complete, a popup will ask you if you
want to view the output files. Click &ldquo;Yes&rdquo;.</li>
</ol></li>
<li>Repeat steps 1 to 3 for as many PDFs as required.</li>
<li>Click &ldquo;Exit&rdquo; when you&rsquo;re done.</li>
</ol>
</div>
</div>


<div id="outline-container-org8f767ba" class="outline-2">
<h2 id="org8f767ba"><span class="section-number-2">3.</span> Technical Description</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-org3cab299" class="outline-3">
<h3 id="org3cab299"><span class="section-number-3">3.1.</span> What?</h3>
<div class="outline-text-3" id="text-3-1">
<p>
<code>yhpdf</code> is a GUI tool which:
</p>
<ul class="org-ul">
<li>Takes an input PDF file.</li>
<li>Splits it into one PDF file per page.</li>
<li>Compresses each page PDF to less than 195KB.</li>
</ul>

<p>
Given the intended use-case, the only platform with first-class
support is MS Windows 10 (compiled binary provided). Other operating
systems may be supported on a per-case basis.
</p>
</div>
</div>

<div id="outline-container-org597ef8a" class="outline-3">
<h3 id="org597ef8a"><span class="section-number-3">3.2.</span> How?</h3>
<div class="outline-text-3" id="text-3-2">
<p>
<code>yhpdf</code> uses PyPDF2 to split the PDF page-wise, then uses
Ghostscript&rsquo;s compression on each of these pages. If the file size
is greater than 195KB, it first tries <code>-dPDFSETTINGS=/ebook</code>. If
the file size is still greater than 195KB, it tries
<code>-dPDFSETTINGS=/screen</code>. This gets most scanned pages below 200KB.
If this fails, it raises an error. In essence, <code>yhpdf</code> is just a
<code>for</code> loop which generates per-page PDFs then compresses them.
</p>

<p>
The GUI uses Tkinter and is cross-platform. If you&rsquo;re proficient in
Python, you can probably get <code>yhpdf.py</code> running in your own
environment.
</p>
</div>
</div>

<div id="outline-container-org38cea13" class="outline-3">
<h3 id="org38cea13"><span class="section-number-3">3.3.</span> Known Issues</h3>
<div class="outline-text-3" id="text-3-3">
<p>
<code>yhpdf</code> is a quickly written program, and will <b>not</b> win any
software engineering competitions. It&rsquo;s meant to do one very
specific job well. Thus, it has many unhandled exceptions, an ugly
interface, and rather ugly code: but it works, and does its job.
</p>

<p>
The biggest user-facing issue is the slow startup time. This is
unfortunately out of <code>yhpdf</code>&rsquo;s control, since <code>pyinstaller</code> in
single file mode needs to decompress the (single) <code>.exe</code> file to
run, which takes time, especially on Windows because of virus
scanning.
</p>

<p>
If this bothers you, either keep it running all the time by
auto-starting it (it uses next to no RAM and CPU while idling), or
get Python and run it from the command line.
</p>
</div>
</div>
</div>

<div id="outline-container-org4b74d66" class="outline-2">
<h2 id="org4b74d66"><span class="section-number-2">4.</span> <code>yhpdf.py</code> Source</h2>
<div class="outline-text-2" id="text-4">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #a52a2a; font-style: italic;"># </span><span style="color: #a52a2a; font-style: italic;">pylint: disable=global-variable-not-assigned, consider-using-with</span>

<span style="color: #84888b; font-style: italic;">"""</span>
<span style="color: #84888b; font-style: italic;">Provides yhpdf.py, standalone GUI application to process PNQ RTO PDFs.</span>
<span style="color: #84888b; font-style: italic;">"""</span>

<span style="color: #e45649;">import</span> tkinter <span style="color: #e45649;">as</span> tk
<span style="color: #e45649;">from</span> tkinter <span style="color: #e45649;">import</span> ttk
<span style="color: #e45649;">from</span> tkinter <span style="color: #e45649;">import</span> filedialog <span style="color: #e45649;">as</span> fd
<span style="color: #e45649;">from</span> tkinter.messagebox <span style="color: #e45649;">import</span> showerror
<span style="color: #e45649;">import</span> sys
<span style="color: #e45649;">import</span> os
<span style="color: #e45649;">from</span> pathlib <span style="color: #e45649;">import</span> Path
<span style="color: #e45649;">import</span> ghostscript
<span style="color: #e45649;">from</span> PyPDF2 <span style="color: #e45649;">import</span> PdfFileWriter, PdfFileReader


<span style="color: #e45649;">def</span> <span style="color: #a626a4;">clear_widget_text</span><span style="color: #4078f2;">(</span>widget<span style="color: #4078f2;">)</span>:
<span style="background-color: #ffffff;"> </span>   <span style="color: #84888b; font-style: italic;">"""Clear widget text"""</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #6a1868;">widget</span><span style="color: #4078f2;">[</span><span style="color: #50a14f;">'text'</span><span style="color: #4078f2;">]</span> = <span style="color: #50a14f;">""</span>


<span style="color: #6a1868;">root</span> = tk.Tk<span style="color: #4078f2;">()</span>
root.title<span style="color: #4078f2;">(</span><span style="color: #50a14f;">"[Yash Honda] PDF Splitter/Compressor"</span><span style="color: #4078f2;">)</span>
root.geometry<span style="color: #4078f2;">(</span><span style="color: #50a14f;">'1000x500'</span><span style="color: #4078f2;">)</span>

<span style="color: #6a1868;">INFO1</span>, <span style="color: #6a1868;">INFO2</span>, <span style="color: #6a1868;">INFO3</span> = ttk.Label<span style="color: #4078f2;">(</span>root<span style="color: #4078f2;">)</span>, ttk.Label<span style="color: #4078f2;">(</span>root<span style="color: #4078f2;">)</span>, ttk.Label<span style="color: #4078f2;">(</span>root,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span> font=<span style="color: #a626a4;">(</span>20<span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>
INFO1.grid<span style="color: #4078f2;">(</span>row=1, column=1, padx=10, pady=30<span style="color: #4078f2;">)</span>
INFO2.grid<span style="color: #4078f2;">(</span>row=2, column=1, padx=10, pady=30<span style="color: #4078f2;">)</span>
INFO3.grid<span style="color: #4078f2;">(</span>row=3, column=1, padx=10, pady=30<span style="color: #4078f2;">)</span>
list_of_vals = <span style="color: #4078f2;">{</span><span style="color: #50a14f;">'filename'</span>: <span style="color: #b751b6;">False</span>, <span style="color: #50a14f;">'dir'</span>: <span style="color: #b751b6;">False</span><span style="color: #4078f2;">}</span>


<span style="color: #e45649;">def</span> <span style="color: #a626a4;">split_and_compress</span><span style="color: #4078f2;">()</span>:
<span style="background-color: #ffffff;"> </span>   <span style="color: #84888b; font-style: italic;">"""Split and compress the actual PDF"""</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">global</span> INFO3
<span style="background-color: #ffffff;"> </span>   clear_widget_text<span style="color: #4078f2;">(</span>INFO3<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">try</span>:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   inputpdf = PdfFileReader<span style="color: #4078f2;">(</span><span style="color: #a626a4;">open</span><span style="color: #a626a4;">(</span><span style="color: #a626a4;">str</span><span style="color: #50a14f;">(</span>list_of_vals<span style="color: #b751b6;">[</span><span style="color: #50a14f;">'filename'</span><span style="color: #b751b6;">]</span><span style="color: #50a14f;">)</span>, <span style="color: #50a14f;">"rb"</span><span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">except</span> <span style="color: #986801;">FileNotFoundError</span>:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   showerror<span style="color: #4078f2;">(</span>title=<span style="color: #50a14f;">'Error'</span>, message=<span style="color: #50a14f;">"File not found!"</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   size_limit = 197500
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">for</span> i <span style="color: #e45649;">in</span> <span style="color: #a626a4;">range</span><span style="color: #4078f2;">(</span>inputpdf.numPages<span style="color: #4078f2;">)</span>:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   output = PdfFileWriter<span style="color: #4078f2;">()</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   output.addPage<span style="color: #4078f2;">(</span>inputpdf.getPage<span style="color: #a626a4;">(</span>i<span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">with</span> <span style="color: #a626a4;">open</span><span style="color: #4078f2;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span> <span style="color: #50a14f;">"wb"</span><span style="color: #4078f2;">)</span> <span style="color: #e45649;">as</span> output_stream:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   output.write<span style="color: #4078f2;">(</span>output_stream<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">if</span> <span style="color: #4078f2;">(</span>size_limit -
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #a626a4;">int</span><span style="color: #a626a4;">(</span>os.stat<span style="color: #50a14f;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span><span style="color: #50a14f;">)</span>.st_size<span style="color: #a626a4;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #4078f2;">)</span> &lt; 0:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   args = <span style="color: #4078f2;">[</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #50a14f;">"-dCompatibilityLevel=1.4"</span>, <span style="color: #50a14f;">"-dNOPAUSE"</span>, <span style="color: #50a14f;">"-dBATCH"</span>, <span style="color: #50a14f;">"-dQUIET"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #50a14f;">"-sDEVICE=pdfwrite"</span>, <span style="color: #50a14f;">"-dPDFSETTINGS=/ebook"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   f<span style="color: #50a14f;">"-sOutputFile=</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/document-page</span>{i}<span style="color: #50a14f;">.pdf"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #4078f2;">]</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   ghostscript.Ghostscript<span style="color: #4078f2;">(</span>*args<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   os.replace<span style="color: #4078f2;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/document-page</span>{i}<span style="color: #50a14f;">.pdf"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>  f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">if</span> <span style="color: #4078f2;">(</span>size_limit -
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #a626a4;">int</span><span style="color: #a626a4;">(</span>os.stat<span style="color: #50a14f;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span><span style="color: #50a14f;">)</span>.st_size<span style="color: #a626a4;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #4078f2;">)</span> &lt; 0:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   args = <span style="color: #4078f2;">[</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #50a14f;">"-dCompatibilityLevel=1.4"</span>, <span style="color: #50a14f;">"-dNOPAUSE"</span>, <span style="color: #50a14f;">"-dBATCH"</span>, <span style="color: #50a14f;">"-dQUIET"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #50a14f;">"-sDEVICE=pdfwrite"</span>, <span style="color: #50a14f;">"-dPDFSETTINGS=/screen"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   f<span style="color: #50a14f;">"-sOutputFile=</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/document-page</span>{i}<span style="color: #50a14f;">.pdf"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #4078f2;">]</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   ghostscript.Ghostscript<span style="color: #4078f2;">(</span>*args<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   os.replace<span style="color: #4078f2;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/document-page</span>{i}<span style="color: #50a14f;">.pdf"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>  f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">if</span> <span style="color: #4078f2;">(</span>size_limit -
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #a626a4;">int</span><span style="color: #a626a4;">(</span>os.stat<span style="color: #50a14f;">(</span>f<span style="color: #50a14f;">"</span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">/doc-page</span>{i}<span style="color: #50a14f;">.pdf"</span><span style="color: #50a14f;">)</span>.st_size<span style="color: #a626a4;">)</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="color: #4078f2;">)</span> &lt; 0:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   showerror<span style="color: #4078f2;">(</span>
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   title=<span style="color: #50a14f;">'Error'</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   message=f<span style="color: #50a14f;">"ERROR: I couldn't compress page </span>{i+1}<span style="color: #50a14f;"> to less than 195KB. \</span>
<span style="color: #50a14f; background-color: #ffffff;"> </span><span style="color: #50a14f;">   </span><span style="color: #50a14f; background-color: #ffffff;"> </span><span style="color: #50a14f;">   </span><span style="color: #50a14f; background-color: #ffffff;"> </span><span style="color: #50a14f;">   </span><span style="color: #50a14f; background-color: #ffffff;"> </span><span style="color: #50a14f;">   Consider using an online compressor or re-scanning."</span><span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   clear_widget_text<span style="color: #4078f2;">(</span>INFO3<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   INFO3<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'text'</span><span style="color: #4078f2;">]</span> = f<span style="color: #50a14f;">"Successfully split and compressed to </span>{i}<span style="color: #50a14f;"> pages"</span>


<span style="color: #e45649;">def</span> <span style="color: #a626a4;">select_file</span><span style="color: #4078f2;">()</span>:
<span style="background-color: #ffffff;"> </span>   <span style="color: #84888b; font-style: italic;">"""Interface for file selection"""</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">global</span> INFO1
<span style="background-color: #ffffff;"> </span>   clear_widget_text<span style="color: #4078f2;">(</span>INFO1<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   filetypes = <span style="color: #4078f2;">(</span><span style="color: #a626a4;">(</span><span style="color: #50a14f;">'PDF files'</span>, <span style="color: #50a14f;">'*.pdf'</span><span style="color: #a626a4;">)</span>, <span style="color: #a626a4;">(</span><span style="color: #50a14f;">'All files'</span>, <span style="color: #50a14f;">'*.*'</span><span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   list_of_vals<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'filename'</span><span style="color: #4078f2;">]</span> = <span style="color: #4078f2;">(</span>fd.askopenfilename<span style="color: #a626a4;">(</span>title=<span style="color: #50a14f;">'Select scanned PDF'</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>  initialdir=<span style="color: #a626a4;">str</span><span style="color: #50a14f;">(</span>Path.home<span style="color: #b751b6;">()</span><span style="color: #50a14f;">)</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>  filetypes=filetypes<span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">if</span> list_of_vals<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'filename'</span><span style="color: #4078f2;">]</span>:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   INFO1<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'text'</span><span style="color: #4078f2;">]</span> = f<span style="color: #50a14f;">"File selected: </span>{list_of_vals['filename']}<span style="color: #50a14f;">"</span>


<span style="color: #e45649;">def</span> <span style="color: #a626a4;">select_directory</span><span style="color: #4078f2;">()</span>:
<span style="background-color: #ffffff;"> </span>   <span style="color: #84888b; font-style: italic;">"""Interface for directory selection"""</span>
<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">global</span> INFO2
<span style="background-color: #ffffff;"> </span>   clear_widget_text<span style="color: #4078f2;">(</span>INFO2<span style="color: #4078f2;">)</span>
<span style="background-color: #ffffff;"> </span>   list_of_vals<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'dir'</span><span style="color: #4078f2;">]</span> = fd.askdirectory<span style="color: #4078f2;">(</span>title=<span style="color: #50a14f;">'Select output folder'</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span> initialdir=<span style="color: #a626a4;">str</span><span style="color: #a626a4;">(</span>Path.home<span style="color: #50a14f;">()</span><span style="color: #a626a4;">)</span><span style="color: #4078f2;">)</span>

<span style="background-color: #ffffff;"> </span>   <span style="color: #e45649;">if</span> list_of_vals<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'dir'</span><span style="color: #4078f2;">]</span>:
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   INFO2<span style="color: #4078f2;">[</span><span style="color: #50a14f;">'text'</span><span style="color: #4078f2;">]</span> = f<span style="color: #50a14f;">"Folder selected: </span>{list_of_vals['<span style="color: #a626a4;">dir</span>']}<span style="color: #50a14f;">"</span>


text = ttk.Label<span style="color: #4078f2;">(</span>
<span style="background-color: #ffffff;"> </span>   root,
<span style="background-color: #ffffff;"> </span>   text=
<span style="background-color: #ffffff;"> </span>   <span style="color: #50a14f;">"This is an internal program. You may not copy, distribute, or sell it."</span><span style="color: #4078f2;">)</span>
text.grid<span style="color: #4078f2;">(</span>row=0, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

open_button = ttk.Button<span style="color: #4078f2;">(</span>root, text=<span style="color: #50a14f;">'Select a file'</span>, command=select_file<span style="color: #4078f2;">)</span>
open_button.grid<span style="color: #4078f2;">(</span>row=1, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

dir_button = ttk.Button<span style="color: #4078f2;">(</span>root,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   text=<span style="color: #50a14f;">"Select output folder"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   command=select_directory<span style="color: #4078f2;">)</span>
dir_button.grid<span style="color: #4078f2;">(</span>row=2, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

process_button = ttk.Button<span style="color: #4078f2;">(</span>root,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   text=<span style="color: #50a14f;">"Process PDF"</span>,
<span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   <span style="background-color: #ffffff;"> </span>   command=split_and_compress<span style="color: #4078f2;">)</span>
process_button.grid<span style="color: #4078f2;">(</span>row=3, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

exit_button = ttk.Button<span style="color: #4078f2;">(</span>root, text=<span style="color: #50a14f;">"Exit"</span>, command=sys.<span style="color: #b751b6;">exit</span><span style="color: #4078f2;">)</span>
exit_button.grid<span style="color: #4078f2;">(</span>row=4, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

text2 = ttk.Label<span style="color: #4078f2;">(</span>root, text=<span style="color: #50a14f;">"All rights reserved.\n(C) Yash Honda 2021"</span><span style="color: #4078f2;">)</span>
text2.grid<span style="color: #4078f2;">(</span>row=5, column=0, padx=10, pady=30<span style="color: #4078f2;">)</span>

root.mainloop<span style="color: #4078f2;">()</span>
</pre>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<hr><p style="font-size: 75%">Created in GNU <a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.1 (<a href="https://orgmode.org">Org</a> mode 9.5.3).</p>
</div>
</body>
</html>
